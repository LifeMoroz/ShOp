<?function add_new_article($title, $writer_id){	$query = "INSERT INTO articles SET title = '$title', writer_id = '$writer_id'";	mysql_query($query);		return mysql_insert_id();}function delete_article($id){	$query = "SELECT img FROM articles WHERE id = '$id'";	$query = mysql_query($query);	$data = mysql_fetch_assoc($query);	if ($img != 'no_img.jpg') unlink(FULL_ARTICLES_GALLERY_PATH . $data['img']);			$query = "DELETE FROM articles WHERE id = $id";	mysql_query($query);		$query = "DELETE FROM comments WHERE article_id = $id";    mysql_query($query);}function update_article($id, $title, $text, $date, $popularity, $on_main, $views_count, $description, $keywords){	$query = "UPDATE articles SET 		title = '$title', 		text = '$text',		date = '$date',		popularity = '$popularity',		on_main = '$on_main',		views_count = '$views_count',		description = '$description', 		keywords = '$keywords'		WHERE id = '$id'	";			mysql_query($query);}function set_article_img($id, $img){	$query = "SELECT img FROM articles WHERE id = '$id'";	$query = mysql_query($query);	$data = mysql_fetch_assoc($query);	if ($img != 'no_img.jpg') unlink(FULL_ARTICLES_GALLERY_PATH . $data['img']);		$query = "UPDATE articles SET img = '$img' WHERE id = '$id'";			mysql_query($query);}function add_views_to_article($id, $count){    $query = "SELECT views_count FROM articles WHERE id = '$id'";    $query = mysql_query($query);    $article = mysql_fetch_assoc($query);	$views_count = $article['views_count'] + $count;	    $query = "UPDATE articles SET views_count = '$views_count' WHERE id = '$id'"; // упростить!!!	mysql_query($query);}function get_top_articles($count){	$data = get_on_main_articles();		if ($data) $count -= count($data);		return get_articles_by_query("SELECT * FROM articles ORDER BY popularity LIMIT $count", 1);}function get_articles_list(){    return get_articles_by_query("SELECT * FROM articles", 1);}function get_articles_list_by_writer_id($writer_id){    return get_articles_by_query("SELECT * FROM articles WHERE writer_id = '$writer_id'", 1);}function get_article_data($id){    return get_articles_by_query("SELECT * FROM articles WHERE id = '$id'", 0);}function get_on_main_articles(){    return get_articles_by_query("SELECT * FROM articles WHERE on_main = '1'", 1);}function get_articles_by_query($query, $is_result_array){    $data = get_norm_mysql_rows($query);    if ($data)    {        for ($i = 0; $i < count($data); $i++)        {            $data[$i]['date'] = int_to_date($data[$i]['date']);            $data[$i]['img'] = ARTICLES_GALLERY_PATH . $data[$i]['img'];						$data[$i]['short_text'] = $data['text']; //!!!						$comments = get_comments_by_article_id($data[$i]['id']);			$data[$i]['comments_count'] = count($comments);						$writer = get_writer_data($data[$i]['writer_id']);			$data[$i]['author'] = $writer['name'];        }        if (count($data) == 1 and !$is_result_array) $articles = $data[0];        else $articles = $data;    }    return $articles;}?>